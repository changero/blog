(window.webpackJsonp=window.webpackJsonp||[]).push([[152],{498:function(s,a,t){"use strict";t.r(a);var n=t(14),r=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("详细描述可以查看"),a("a",{attrs:{href:"https://juejin.cn/post/7011024137707585544",target:"_blank",rel:"noopener noreferrer"}},[s._v("文章"),a("OutboundLink")],1),s._v("，这里仅描述使用事项")]),s._v(" "),a("h2",{attrs:{id:"创建项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建项目"}},[s._v("#")]),s._v(" 创建项目")]),s._v(" "),a("p",[s._v("再任意目录下创建一个"),a("code",[s._v("package.json")]),s._v("文件，内容如下：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"project name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"private"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"workspaces"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"project1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"project2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("注意"),a("code",[s._v("private: true")]),s._v("，这是必要的。"),a("code",[s._v("workspaces")]),s._v("的值还可以是另一种形式")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"workspaces"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"projects/*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("接着创建 2 个项目"),a("code",[s._v("project1")]),s._v("、"),a("code",[s._v("project2")]),s._v("，并分别创建"),a("code",[s._v("package.json")]),s._v("文件")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"project1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"version"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dependecies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("blockquote",[a("p",[s._v("注意 name 字段的值一定要与文件夹名字相同")])]),s._v(" "),a("h2",{attrs:{id:"安装依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装依赖"}},[s._v("#")]),s._v(" 安装依赖")]),s._v(" "),a("blockquote",[a("p",[s._v("需要 workspaces 下项目中的 package.json 中已经有 dependecies")])]),s._v(" "),a("p",[s._v("再项目中安装的时候，可以在任意目录下通过"),a("code",[s._v("yarn")]),s._v("安装。安装的时候会将所有的依赖安装在"),a("code",[s._v("workspaceroot")]),s._v("目录下，这样可以避免重复安装。如果过整个项目依赖了相同包的不同版本，才会在某个项目目录下安装特定的版本")]),s._v(" "),a("h2",{attrs:{id:"命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令"}},[s._v("#")]),s._v(" 命令")]),s._v(" "),a("h3",{attrs:{id:"workspace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#workspace"}},[s._v("#")]),s._v(" workspace")]),s._v(" "),a("h5",{attrs:{id:"yarn-workspace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#yarn-workspace"}},[s._v("#")]),s._v(" yarn workspace")]),s._v(" "),a("p",[s._v("命令格式：")]),s._v(" "),a("blockquote",[a("p",[s._v("yarn workspace [workspace_name] [command]")])]),s._v(" "),a("p",[s._v("作用：在指定的 workspace 下执行 command，即 command 作用域为某个 workspace。示例：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为app1安装react")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" workspace app1 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" react --save\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行app1中的start脚本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" workspace app1 run start\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h5",{attrs:{id:"yarn-workspaces-info-json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#yarn-workspaces-info-json"}},[s._v("#")]),s._v(" yarn workspaces info [--json]")]),s._v(" "),a("p",[s._v("作用：此命令将显示当前项目的工作空间依赖关系树。示例：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" workspaces info\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h5",{attrs:{id:"yarn-workspaces-run-command"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#yarn-workspaces-run-command"}},[s._v("#")]),s._v(" yarn workspaces run [command]")]),s._v(" "),a("p",[s._v("作用：将在每个工作区中运行所选择的 Yarn 命令，即遍历所有 workspace 执行 command 命令，示例：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在所有workspace中执行yarn start命令")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" workspaces run start\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在所有workspace中执行yarn test命令")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" workspaces run "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h5",{attrs:{id:"_2-x-新增-yarn-workspaces-focus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-x-新增-yarn-workspaces-focus"}},[s._v("#")]),s._v(" [2.x 新增]yarn workspaces focus")]),s._v(" "),a("blockquote",[a("p",[s._v("要使用此命令，请先安装 workspace-tools 插件：yarn plugin import workspace-tools")])]),s._v(" "),a("p",[s._v("作用：安装单个工作区及其依赖项。")]),s._v(" "),a("h5",{attrs:{id:"_2-x-新增-yarn-workspaces-foreach-command"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-x-新增-yarn-workspaces-foreach-command"}},[s._v("#")]),s._v(" [2.x 新增]yarn workspaces foreach [command]")]),s._v(" "),a("blockquote",[a("p",[s._v("要使用此命令，请先安装 workspace-tools 插件：yarn plugin import workspace-tools")])]),s._v(" "),a("p",[s._v("作用：在所有工作空间上运行 command 命令(有点类似 Yarn 1.x 中的 yarn workspaces)。示例：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" workspaces foreach run start\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h5",{attrs:{id:"yarn-workspaces-list"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#yarn-workspaces-list"}},[s._v("#")]),s._v(" yarn workspaces list")]),s._v(" "),a("blockquote",[a("p",[s._v("注意：需要在 workspace-root 下执行。 作用：列出所有可用的工作区。示例：")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" workspaces list\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);