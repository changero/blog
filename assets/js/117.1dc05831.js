(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{459:function(s,t,a){"use strict";a.r(t);var e=a(14),r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"代码校验-eslint"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#代码校验-eslint"}},[s._v("#")]),s._v(" 代码校验 - Eslint")]),s._v(" "),t("p",[t("code",[s._v("eslint")]),s._v("的作用是检查代码中不符合规则的地方，它跟很多 IDE 以及编辑器都能很好的结合，我们简单说一下在项目中的整合")]),s._v(" "),t("h3",{attrs:{id:"安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" eslint -D\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" eslint -D\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"初始化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#初始化"}},[s._v("#")]),s._v(" 初始化")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ npx eslint --init\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),s._v(" "),t("p",[s._v("会通过交互式的方式生成 eslint 的配置文件")]),s._v(" "),t("h3",{attrs:{id:"使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[s._v("#")]),s._v(" 使用")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("npx eslint --fix --ext .js,.jsx src/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("或者配置到 package.json 文件中")]),s._v(" "),t("p",[s._v("eslint 官方还提供有很多其他的规则，具体的可以查看官网")]),s._v(" "),t("p",[s._v("推荐在 vscode 这种安装"),t("code",[s._v("Lintel")]),s._v("插件，提供可视化编辑 eslint 文件的功能")]),s._v(" "),t("h3",{attrs:{id:"忽略文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#忽略文件"}},[s._v("#")]),s._v(" 忽略文件")]),s._v(" "),t("p",[s._v("通过"),t("code",[s._v(".eslintignore")]),s._v("文件配置")]),s._v(" "),t("h3",{attrs:{id:"eslint-config-prettier"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#eslint-config-prettier"}},[s._v("#")]),s._v(" eslint-config-prettier")]),s._v(" "),t("p",[s._v("这个包是用来禁用 eslint 中可能会于 prettier 产生冲突的规则")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" eslint-config-prettier -D\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("添加配置")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"extends"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"some-other"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prettier"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"代码格式-prettier"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#代码格式-prettier"}},[s._v("#")]),s._v(" 代码格式 - prettier")]),s._v(" "),t("p",[s._v("prettier 有一套自己的规则来格式化代码，也就是我们安装这个工具，就表示我们需要遵守它的规则")]),s._v(" "),t("h3",{attrs:{id:"安装-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装-2"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" prettier\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"使用-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-2"}},[s._v("#")]),s._v(" 使用")]),s._v(" "),t("p",[s._v("在 package.json 中添加一个脚本")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"prettier"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prettier --write src"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("执行 prettier 脚本，就可以自动格式化 src 目录下的代码，"),t("code",[s._v("--write")]),s._v("参数表示将格式化之后的内容写回到文件中，否则只是会输出到控制台")]),s._v(" "),t("h2",{attrs:{id:"prettier-eslint"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prettier-eslint"}},[s._v("#")]),s._v(" prettier-eslint")]),s._v(" "),t("p",[s._v("这个配置工具整合了 prettier 和 eslint，帮我们手动去创建对应的配置文件")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" init prettier-eslint\nnpx create-prettier-eslint\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" create prettier-eslint\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("除此之外，也建议在 vscode 中安装"),t("code",[s._v("prettier-eslint")]),s._v("插件，可以专门帮助我们解决 js 或 ts 文件的格式化问题，尤其在规则配置和格式化配置有冲突的时候非常有用")]),s._v(" "),t("h2",{attrs:{id:"prettier-eslint-cli"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prettier-eslint-cli"}},[s._v("#")]),s._v(" prettier-eslint-cli")]),s._v(" "),t("p",[s._v("当我们在执行 prettier 的时候，是不能同时对代码进行校验的，这个工具的作用就是在 prettier 的同时对 js 文件不符合规则的地方进行修改")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("npx prettier-eslint --write src/**/*.js --\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("这个工具安装之后的可执行文件名就叫"),t("code",[s._v("prettier-eslint")])]),s._v(" "),t("li",[s._v("与"),t("code",[s._v("prettier")]),s._v("不同的是它不能作用于目录，只能匹配文件")])]),s._v(" "),t("h2",{attrs:{id:"结合-vscode"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#结合-vscode"}},[s._v("#")]),s._v(" 结合 vscode")]),s._v(" "),t("p",[s._v("以上工具都是我们直接在项目当中，通过 npm 来安装使用，我们需要去结合相应的命令来达到使用上述工具的目的。")]),s._v(" "),t("p",[s._v("在 vscode 或其他编辑工具中，是可以实现在编辑文件之后，保存的时候实时的去完成上述工作，并且实时的显示代码的问题")]),s._v(" "),t("p",[s._v("首先我们需要安装几个插件，分别是上述工具对应的插件，最主要的就是"),t("code",[s._v("eslint")]),s._v("和"),t("code",[s._v("prettier")])]),s._v(" "),t("p",[s._v("eslint 插件会自动读取我们配置在项目中配置文件，基本不需要在编辑器上面配置 eslint 的相关规则")]),s._v(" "),t("p",[s._v("而我们要实现在保存文件的时候自动使用 prettier 来进行格式化，就需要设置 prettier 为默认的格式化工具，在 vscode 的 setting 页面搜索"),t("code",[s._v("formatter")]),s._v("，可以找到默认的配置，或者单独为某一类文件进行配置")]),s._v(" "),t("p",[s._v("最后就是开启"),t("code",[s._v("formatOnSave")]),s._v("，这样保存的时候，就能够实时的对文件进行格式化")]),s._v(" "),t("p",[s._v("一般而言，进过上述的设置 eslint 和 prettier 都能够很好的配合工偶，但有的时候，项目中修改了某些 lint 规则，导致在格式化的时候与 lint 规则冲突，而出现错误。这个时候我们就需要响应的调整格式化的配置")]),s._v(" "),t("p",[s._v("推荐使用"),t("code",[s._v("prettier-eslint")]),s._v("插件，将诸如"),t("code",[s._v("js")]),s._v("文件之类的默认 formatter 修改为")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"[javascript]"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"editor.defaultFormatter"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rvest.vs-code-prettier-eslint"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("这样就能使得在格式化的时候配合 eslint 的规则")]),s._v(" "),t("p",[s._v("如果是 vue 文件，推荐的格式器是"),t("code",[s._v("vetur")]),s._v("，或者"),t("code",[s._v("volar")]),s._v("。推荐安装"),t("code",[s._v("vue volar Extention Pack")]),s._v("集合包，比如使用 vrtur 进行格式，我们就可以针对 vetur 来调整不同的参数。具体参数设置可以参考其他文档")]),s._v(" "),t("h2",{attrs:{id:"与-git-整合"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#与-git-整合"}},[s._v("#")]),s._v(" 与 git 整合")]),s._v(" "),t("p",[s._v("我们的目标很简单，就是在提交代码的时候自动 lint 并对格式进行修复")]),s._v(" "),t("h3",{attrs:{id:"husky"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#husky"}},[s._v("#")]),s._v(" husky")]),s._v(" "),t("p",[s._v("husky 提供 git 操作的各种钩子，常用的如"),t("code",[s._v("pre-commit")])]),s._v(" "),t("p",[t("a",{attrs:{href:"../node/husky"}},[s._v("继续阅读")])]),s._v(" "),t("h3",{attrs:{id:"lins-staged"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lins-staged"}},[s._v("#")]),s._v(" lins-staged")]),s._v(" "),t("p",[s._v("lint-staged 的作用是仅对暂存区的文件执行操作")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"lint-staged"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"*.js"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prettier-eslint --write"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git add"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"*.css"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prettier --write"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git add"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("这样在文件提交之间可以自动的执行 ling 和 prettier")])])}),[],!1,null,null,null);t.default=r.exports}}]);