---
title: 前端工程化-代码规范
date: "2021-05-09 18:00:08"
categories:
  - 前端
tags:
  - 工程化
lang: zh-cn
---

## 代码校验 - Eslint

`eslint`的作用是检查代码中不符合规则的地方，它跟很多 IDE 以及编辑器都能很好的结合，我们简单说一下在项目中的整合

### 安装

```bash
$ npm install eslint -D
$ yarn add eslint -D
```

### 初始化

```bash
$ npx eslint --init
```

<!-- more -->

会通过交互式的方式生成 eslint 的配置文件

### 使用

```bash
npx eslint --fix --ext .js,.jsx src/
```

或者配置到 package.json 文件中

eslint 官方还提供有很多其他的规则，具体的可以查看官网

### 忽略文件

通过`.eslintignore`文件配置

### eslint-config-prettier

这个包是用来禁用 eslint 中可能会于 prettier 产生冲突的规则

```bash
$ npm install eslint-config-prettier -D
```

添加配置

```json
{
  "extends": ["some-other", "prettier"]
}
```

## 代码格式 - prettier

prettier 有一套自己的规则来格式化代码，也就是我们安装这个工具，就表示我们需要遵守它的规则

### 安装

```bash
$ npm install prettier
```

### 使用

在 package.json 中添加一个脚本

```json
{
  "scripts": {
    "prettier": "prettier --write src"
  }
}
```

执行 prettier 脚本，就可以自动格式化 src 目录下的代码，`--write`参数表示将格式化之后的内容写回到文件中，否则只是会输出到控制台

## prettier-eslint

这个配置工具整合了 prettier 和 eslint，帮我们手动去创建对应的配置文件

```bash
npm init prettier-eslint
npx create-prettier-eslint
yarn create prettier-eslint
```

## prettier-eslint-cli

当我们在执行 prettier 的时候，是不能同时对代码进行校验的，这个工具的作用就是在 prettier 的同时对 js 文件不符合规则的地方进行修改

```
npx prettier-eslint --write src/**/*.js --
```

- 这个工具安装之后的可执行文件名就叫`prettier-eslint`
- 与`prettier`不同的是它不能作用于目录，只能匹配文件

## 与 git 整合

我们的目标很简单，就是在提交代码的时候自动 lint 并对格式进行修复

### husky

husky 提供 git 操作的各种钩子，常用的如`pre-commit`

[继续阅读](../node/husky)

### lins-staged

lint-staged 的作用是仅对暂存区的文件执行操作

```json
{
  "lint-staged": {
    "*.js": ["prettier-eslint --write", "git add"],
    "*.css": ["prettier --write", "git add"]
  }
}
```

这样在文件提交之间可以自动的执行 ling 和 prettier
