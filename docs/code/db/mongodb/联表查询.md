---
title: 联表查询
date: '2021-12-05 17:52:16'
categories:
  - 数据库
tags:
  - mongodb
lang: zh-cn
---

## 创建 Schema

```js
const UserSchema = mongoose.Schem({
  name: String,
  age: Number,
});

const User = mongoose.model('user', UserSchema);

const ArticalSchema = mongoose.Schem({
  content: String,
  title: String,
  // 关联user
  user: {
    type: mongoose.Schem.Types.ObjectId,
    ref: 'user',
  },
});

const Artical = mongoose.model('artical', ArticalSchema);
```

<!-- more -->

## 创建数据

```js
const user = new User({
  name: '张三',
  age: 18,
});

user.save(function(err, result) {
  if (err) return;
  const id = result._id;
  const artical = new Artical({
    title: '标题',
    content: '内容',
    user: _id,
  });
  artical.save();
});
```

## 查询

```js
Artical.find({ _id: 'artical_id' }).then((doc) => {
  console.log(doc); // { title: '', content: '', user: '_id' }
});
```

如果要查出文章关联的 user 的信息

```js
Artical.find({ _id: 'artical_id' })
  .populate('user')
  .exec()
  .then((doc) => {
    console.log(doc); // { title: '', content: '', user: { name: '张三', age: 18, _id } }
  });
```
