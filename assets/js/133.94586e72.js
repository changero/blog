(window.webpackJsonp=window.webpackJsonp||[]).push([[133],{476:function(t,s,e){"use strict";e.r(s);var a=e(14),i=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h3",{attrs:{id:"第一步-安装-git"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第一步-安装-git"}},[t._v("#")]),t._v(" 第一步：安装 git")]),t._v(" "),s("blockquote",[s("p",[t._v("sudo apt update\nsudo apt install git")])]),t._v(" "),s("h3",{attrs:{id:"第二步-创建-git-用户"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第二步-创建-git-用户"}},[t._v("#")]),t._v(" 第二步：创建 git 用户")]),t._v(" "),s("p",[t._v("创建一个 git 用户，用来运行 git 服务：")]),t._v(" "),s("blockquote",[s("p",[t._v("sudo adduser git")])]),t._v(" "),s("h3",{attrs:{id:"第三步-创建证书登录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第三步-创建证书登录"}},[t._v("#")]),t._v(" 第三步: 创建证书登录")]),t._v(" "),s("p",[t._v("收集所有需要登录的用户的公钥，就是他们自己的 id_rsa.pub 文件，把所有公钥导入到"),s("code",[t._v("/home/git/.ssh/authorized_keys")]),t._v("文件里，一行一个。")]),t._v(" "),s("h3",{attrs:{id:"第四步-初始化-git-仓库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第四步-初始化-git-仓库"}},[t._v("#")]),t._v(" 第四步: 初始化 Git 仓库")]),t._v(" "),s("p",[t._v("先选定一个目录作为 Git 仓库，假定是"),s("code",[t._v("/srv/sample.git")]),t._v("，在/srv 目录下输入命令")]),t._v(" "),s("blockquote",[s("p",[t._v("sudo git init --bare sample.git")])]),t._v(" "),s("p",[t._v("Git 就会创建一个裸仓库，裸仓库没有工作区，因为服务器上的 Git 仓库纯粹是为了共享，所以不让用户直接登录到服务器上去改工作区，并且服务器上的 Git 仓库通常都以"),s("code",[t._v(".git")]),t._v("结尾。然后，把 owner 改为"),s("code",[t._v("git")]),t._v(":")]),t._v(" "),s("blockquote",[s("p",[t._v("sudo chown -R git:git sample.git")])]),t._v(" "),s("h3",{attrs:{id:"第五步-禁用-shell-登录-可选"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第五步-禁用-shell-登录-可选"}},[t._v("#")]),t._v(" 第五步：禁用 shell 登录（可选）")]),t._v(" "),s("p",[t._v("出于安全考虑，第二步创建的 git 用户不允许登录 shell，这可以通过编辑/etc/passwd 文件完成。找到类似下面的一行：")]),t._v(" "),s("blockquote",[s("p",[t._v("git: x :1001:1001:,,,:/home/git:/bin/bash")])]),t._v(" "),s("p",[t._v("改为：")]),t._v(" "),s("blockquote",[s("p",[t._v("git: x :1001:1001:,,,:/home/git:/usr/bin/git-shell")])]),t._v(" "),s("p",[t._v("这样，"),s("code",[t._v("git")]),t._v("用户可以正常通过"),s("code",[t._v("ssh")]),t._v("使用"),s("code",[t._v("git")]),t._v("，但无法登录"),s("code",[t._v("shell")]),t._v("，因为我们为"),s("code",[t._v("git")]),t._v("用户指定的"),s("code",[t._v("git-shell")]),t._v("每次一登录就自动退出。")]),t._v(" "),s("h3",{attrs:{id:"第六步-克隆远程仓库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第六步-克隆远程仓库"}},[t._v("#")]),t._v(" 第六步: 克隆远程仓库")]),t._v(" "),s("p",[t._v("现在，可以通过"),s("code",[t._v("git clone")]),t._v("命令克隆远程仓库了，在各自的电脑上运行：")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone git@server:/srv/sample.git\nCloning into "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sample'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nwarning: You appear to have cloned an empty repository.\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("ul",[s("li",[t._v("原文地址:"),s("a",{attrs:{href:"https://www.liaoxuefeng.com/wiki/896043488029600/899998870925664",target:"_blank",rel:"noopener noreferrer"}},[t._v("搭建 Git 服务器 - 廖雪峰的官方网站"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=i.exports}}]);