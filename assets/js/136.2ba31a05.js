(window.webpackJsonp=window.webpackJsonp||[]).push([[136],{479:function(e,s,r){"use strict";r.r(s);var a=r(14),t=Object(a.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h2",{attrs:{id:"安装-harbor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-harbor"}},[e._v("#")]),e._v(" 安装 harbor")]),e._v(" "),s("p",[e._v("到"),s("a",{attrs:{href:"https://github.com/goharbor/harbor/releases",target:"_blank",rel:"noopener noreferrer"}},[e._v("Releases · goharbor/harbor · GitHub"),s("OutboundLink")],1),e._v("页面下载离线包,比如："),s("a",{attrs:{href:"https://github.com/goharbor/harbor/releases/download/v2.3.4/harbor-offline-installer-v2.3.4.tgz",target:"_blank",rel:"noopener noreferrer"}},[e._v("harbor-offline-installer-v2.3.4.tgz"),s("OutboundLink")],1)]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("tar")]),e._v(" -xvf harbor-offline-installer-v2.3.4.tgz\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("解压以后修改其中的 harbor.yml 配置文件，并执行"),s("code",[e._v("./install.sh")]),e._v("开始安装")]),e._v(" "),s("h3",{attrs:{id:"生成自验证证书"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生成自验证证书"}},[e._v("#")]),e._v(" 生成自验证证书")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("生成服务器私钥")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("openssl genrsa -des3 -out server.key 2048\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])])]),e._v(" "),s("li",[s("p",[e._v("生成服务器签署申请文件")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("openssl req -new -out server.csr -key server.key -config /etc/ssl/openssl.cnf\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])])]),e._v(" "),s("li",[s("h5",{attrs:{id:"从秘钥中删除-passphrase"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#从秘钥中删除-passphrase"}},[e._v("#")]),e._v(" 从秘钥中删除 Passphrase")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("cp server.key server.key.org\nopenssl rsa -in server.key.org -out server.key\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])])]),e._v(" "),s("li",[s("p",[e._v("签名，生成一个 3650 天的临时证书")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("openssl x509 -req -days 3650 -in server.csr -signkey server.key -out server.crt\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])])])]),e._v(" "),s("p",[e._v("参考使用 CA 创建证书,"),s("a",{attrs:{href:"https://www.cnblogs.com/buptleida/p/12090237.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("https 搭建(自签名证书) - 数小钱钱的种花兔 - 博客园 (cnblogs.com)"),s("OutboundLink")],1),e._v("或者"),s("a",{attrs:{href:"https://www.jianshu.com/p/e5f46dcf4664",target:"_blank",rel:"noopener noreferrer"}},[e._v("如何创建自签名的 SSL 证书 - 简书 (jianshu.com)"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"登陆"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#登陆"}},[e._v("#")]),e._v(" 登陆")]),e._v(" "),s("p",[e._v("修改"),s("code",[e._v("/etc/docker/daemon.json")])]),e._v(" "),s("p",[e._v("添加")]),e._v(" "),s("div",{staticClass:"language-json line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"insecure-registries"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://harbor的ip和端口"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])])])}),[],!1,null,null,null);s.default=t.exports}}]);