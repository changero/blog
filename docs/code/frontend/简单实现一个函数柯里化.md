---
title: 简单实现一个函数柯里化
date: 2020-12-12
categories:
  - 前端
---

```js
function add() {
  const fun = arguments.callee.bind(this, ...arguments);
  const sum = [...arguments].reduce((sum, num) => (sum += num), 0);
  fun.valueOf = () => sum;
  return fun;
}

+add(1)(2)(3); // 6
+add(1, 2, 3); // 6
+add(1)(2, 3); // 6
```

更通用的写法是把计算 sum 的方法通过参数传入

```js
function create(fn) {
  return function inner() {
    const fun = arguments.callee.bind(this, ...arguments);
    const sum = fn(...arguments);
    fun.valueOf = () => sum;
    return fun;
  };
}

const add = create(function() {
  return [...arguments].reduce((sum, num) => (sum += num), 0);
});

const mul = create(function() {
  return [...arguments].reduce((sum, num) => (sum *= num), 1);
});
+mul(1)(2)(3); // 6
+mul(1, 2, 4); // 8
```

也可以优化计算过程，将 sum 的计算放到 valueOf 里面，避免不必要的计算

```js
function create(fn) {
  return function inner() {
    const fun = arguments.callee.bind(this, ...arguments);
    fun.valueOf = () => fn(...arguments);
    return fun;
  };
}
```

最后，还可以自行实现通过缓存计算结果的方式优化效率
