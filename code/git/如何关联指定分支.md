---
title: å¦‚ä½•å…³è”æŒ‡å®šåˆ†æ”¯
date: "2021-06-02 22:26:04"
categories:
  - git
lang: zh-cn
---

## èƒŒæ™¯

åœ¨å¼€å‘å¤§å‹é¡¹ç›®çš„æ—¶å€™ï¼Œä¼šæ ¹æ®ä¸åŒçš„è¿­ä»£å’Œå¼€å‘äººå‘˜ï¼Œå‡ºç°å¾ˆå¤šçš„åˆ†æ”¯ï¼Œè¿™äº›åˆ†æ”¯å¯èƒ½çºµæ¨ªäº¤é”™ï¼Œåœ¨å¯è§†åŒ–å·¥å…·é‡Œé¢å¼€ä¸Šå»å°±åƒä¸€å¼ å·¨å¤§çš„ç½‘ä¸€æ ·ï¼Œä¹Ÿä¸å…·å¤‡äº†å¯è¯†åˆ«æ€§ã€‚è€ŒåŒæ—¶ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œæœ‰å¾ˆå¤šåˆ†æ”¯åˆæ˜¯ä¸å†ç»´æŠ¤çš„ï¼Œå½“ç„¶ä¹Ÿä¸ä¼šåˆäººæ•¢çœŸæ­£çš„å»åˆ ï¼Œæ‰€ä»¥ï¼Œæˆ‘éœ€è¦ä¸€ä¸ªæ–¹æ³•èƒ½ç®€æ´çš„æ˜¾ç¤ºæˆ‘æ‰€éœ€è¦çš„åˆ†æ”¯

## å®ç°æ–¹æ³•

### 1ã€å…³è”ä»“åº“

ç¬¬ä¸€æ­¥æ˜¯å…³è”ä»“åº“ï¼Œè¿™ä¸€æ­¥å¯ä»¥é€šè¿‡ä¼ ç»Ÿçš„`git clone`æ¥å…³è”ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨åˆ›å»ºæ–‡ä»¶å¤¹ä¹‹åæ·»åŠ è¿œç¨‹ä»“åº“

ç¬¬ä¸€ç§

```bash
git clone --depth=100 -b master [git repo url]
```

åœ¨ clone çš„æ—¶å€™æ·»åŠ `--depth`å’Œ`-b`å‚æ•°èƒ½å¤Ÿåª clone æŒ‡å®šçš„åˆ†æ”¯ï¼Œä¾‹å¦‚ master

<!-- more -->

ç¬¬äºŒç§

```bash
mkdir gitdemo && cd gitdemo

git remote add -t [branch] -f --no-tags origin [git repo url]

# å…³è”æœ¬åœ°ä¸è¿œç¨‹åˆ†æ”¯
git branch --set-upstream-to=origin/[branch] [branch]
```

> `-f`å‚æ•°è¡¨ç¤º fetchï¼Œ`--no-tags`è¡¨ç¤ºä¸è·å– tag

### 2ã€æ·»åŠ å…³è”è¿œç¨‹åˆ†æ”¯

```bash
git remote set-branches --add origin [éœ€è¦å…³è”çš„è¿œç¨‹åˆ†æ”¯]
```

ä¸€èˆ¬åœ¨ä¸€ä¸ªæ–°çš„è¿­ä»£é˜¶æ®µï¼Œä»ä¸»åˆ†æ”¯è¿å‡ºä¸€ä¸ªå¼€å‘åˆ†æ”¯ä¹‹åï¼Œå¼€å‘è€…è‡ªè¡Œå…³è”ã€‚

### 3ã€åˆ é™¤è¿œç¨‹åˆ†æ”¯å…³è”

å¼€å‘ç»“æŸä¹‹åå¦‚æœéœ€è¦åˆ é™¤è¿™ä¸ªåˆ†æ”¯

```bash
git branch -d [branch]
```

åˆ é™¤ origin/[branch]ï¼Œæ³¨æ„ä¸æ˜¯åˆ é™¤è¿œç¨‹åˆ†æ”¯ï¼Œè€Œæ˜¯åˆ é™¤æœ¬åœ°çš„è¿œç¨‹å…³è”

æ‰¾åˆ°`.git>refs>remotes`æ–‡ä»¶å¤¹ï¼Œåˆ é™¤åˆ†æ”¯åå¯¹åº”çš„æ–‡ä»¶å³å¯

ä»¥ä¸Šæ­¥éª¤å®Œæˆä»¥åï¼Œåœ¨ä¸‹æ¬¡æ›´æ–°è¿œç¨‹åˆ†æ”¯ï¼ˆfetch/pullï¼‰çš„æ—¶å€™è¿˜æ˜¯ä¼šæŠŠåˆšæ‰çš„åˆ†æ”¯ä¸‹è½½ä¸‹æ¥

æ‰€ä»¥è¿˜éœ€è¦ä¸€æ­¥ï¼Œæ‰“å¼€`.git/config`æ–‡ä»¶ï¼Œæ‰¾åˆ°ä½ è¦åˆ é™¤çš„åˆ†æ”¯åç›´æ¥åˆ é™¤

### ä¾‹å­ ğŸŒ°

å…ˆå‡è®¾ä¸€ä¸ªåˆ†æ”¯`feature/env`

- é¦–å…ˆåˆ é™¤æœ¬åœ°è¿™ä¸ªåˆ†æ”¯

```bash
$ git branch -d feature/env
```

å¯¹åº”çš„æ–‡ä»¶æ“ä½œæ˜¯ï¼Œåˆ é™¤`.git/refs/heads/feature/env`

- å†åˆ é™¤å†æœ¬åœ°çš„è¿œç¨‹åˆ†æ”¯

```bash
$ git branch -d -r origin/feature/env
```

å¯¹åº”çš„æ–‡ä»¶æ“ä½œæ˜¯ï¼Œåˆ é™¤`.git/refs/remotes/origin/feature/env`

ç°åœ¨å¯ä»¥é€šè¿‡`git remote show origin`ï¼ŒæŸ¥çœ‹è¿œç¨‹åˆ†æ”¯çš„çŠ¶æ€

```bash
$ git remote show origin
```

è¿™ä¸ªå‘½ä»¤ä¸`git branch -a`çš„åŒºåˆ«åœ¨äºï¼Œå‰è€…ä¼šè”ç½‘æ£€æŸ¥è¿œç¨‹åˆ†æ”¯ï¼Œè€Œåè€…ä¹‹åæ£€æŸ¥æœ¬åœ°åˆ†æ”¯æ‰€å…³è”çš„è¿œç¨‹åˆ†æ”¯

è¿™ä¸ªæ—¶å€™é€šè¿‡`remote show`å°±å¯ä»¥å‘ç°`feature/env`è¿œç¨‹åˆ†æ”¯åé¢æœ‰å¥è¯`new (next fetch will store in remotes/origin)`

è¡¨ç¤ºå†ä¸‹æ¬¡æ‰§è¡Œ`fetch`æ“ä½œçš„æ—¶å€™ä¼šé‡æ–°å°†è¯¥è¿œç¨‹åˆ†æ”¯å…³è”ä¸Š

æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥åˆ æ‰è¿™ä¸ªåˆ†æ”¯

> ä¸æ˜¯çœŸæ­£çš„åˆ æ‰è¿œç¨‹ä¸Šçš„è¿™ä¸ªåˆ†æ”¯

#### åˆ é™¤å…³è”

- å‘½ä»¤è¡Œæ–¹å¼

  ```bash
  $ git remote set-branches origin master // åªä¿ç•™master
  $ git remote set-branches --add origin otherBranch // æ·»åŠ å…¶ä»–åˆ†æ”¯
  ```

- ä¿®æ”¹æ–‡ä»¶çš„æ–¹å¼

æ‰¾åˆ°`.git/config`æ–‡ä»¶ï¼Œæ–‡ä»¶æœ€å¼€å§‹å¯èƒ½æ˜¯è¿™æ ·çš„

```
[core]
	repositoryformatversion = 0
	filemode = false
	bare = false
	logallrefupdates = true
	symlinks = false
	ignorecase = true
[submodule]
	active = .
[remote "origin"]
	url = ã€è¿œç¨‹åˆ†æ”¯åœ°å€ã€‘
	fetch = +refs/heads/*:refs/remotes/origin/*
[branch "master"]
	remote = origin
	merge = refs/heads/master

```

éœ€è¦ä¿®æ”¹çš„æ˜¯ remote é‚£ä¸€é¡¹

```
[remote "origin"]
	url = ã€è¿œç¨‹åˆ†æ”¯åœ°å€ã€‘
	fetch = +refs/heads/master:refs/remotes/origin/master
	fetch = +refs/heads/otherBranch:refs/remotes/origin/otherBranch
```

è¿™æ ·å°±å®ç°äº†åªå…³è”éœ€è¦çš„åˆ†æ”¯
